DROP TABLE IF EXISTS FEEDBACK CASCADE;
DROP TABLE IF EXISTS TEAM CASCADE;
DROP TABLE IF EXISTS PROJECT CASCADE;
DROP TABLE IF EXISTS EMPLOYER CASCADE;

CREATE TABLE EMPLOYER
(
    ID              SERIAL PRIMARY KEY,
    NAME            TEXT,
    SURNAME         TEXT,
    PATRONYMIC      TEXT,
    MAIL            TEXT,
    TEL             TEXT,
    BIRTHDAY        TIMESTAMP,
    EXPERIENCE      INT,
    EMPLOYMENT_DATA TIMESTAMP,
    WORK_SKILL      CHAR(2),
    ENGLISH_SKILL   CHAR(2),
    SKYPE           TEXT,
    FEEDBACK_ID     INT
);

CREATE TABLE FEEDBACK
(
    ID   SERIAL PRIMARY KEY,
    TEXT TEXT,
    DATE TIMESTAMP
);

CREATE TABLE TEAM
(
    ID           SERIAL PRIMARY KEY,
    TEAM_NAME_ID INT,
    EMPLOYER_ID  INT
);

CREATE TABLE TEAM_NAME
(
    ID   SERIAL PRIMARY KEY NOT NULL,
    NAME TEXT
);

CREATE TABLE PROJECT
(
    ID              SERIAL PRIMARY KEY NOT NULL,
    NAME            TEXT,
    COSTUMER        TEXT,
    FINISH_DATE     TIMESTAMP,
    METHODOLOGY     TEXT,
    PROJECT_MANAGER TEXT,
    TEAM_NAME_ID    INT
);

ALTER TABLE EMPLOYER
    ADD CONSTRAINT EMPLOYER_PROJECT_ID_FK FOREIGN KEY (PROJECT_ID) REFERENCES PROJECT (ID);
ALTER TABLE EMPLOYER
    ADD CONSTRAINT EMPLOYER_FEEDBACK_ID_FK FOREIGN KEY (FEEDBACK_ID) REFERENCES FEEDBACK (ID);
ALTER TABLE TEAM
    ADD CONSTRAINT TEAM_EMPLOYER_ID_FK FOREIGN KEY (EMPLOYER_ID) REFERENCES EMPLOYER (ID);
ALTER TABLE TEAM
    ADD CONSTRAINT TEAM_TEAM_NAME_ID_FK FOREIGN KEY (TEAM_NAME_ID) REFERENCES TEAM_NAME (ID);
ALTER TABLE PROJECT
    ADD CONSTRAINT PROJECT_TEAM_NAME_ID_FK FOREIGN KEY (TEAM_NAME_ID) REFERENCES TEAM_NAME (ID);

INSERT INTO TEAM_NAME (NAME)
VALUES ('Команда А'),
       ('Команда Б');

INSERT INTO FEEDBACK (TEXT, DATE)
VALUES ('Замечательно справился', '2021-01-01 12:00:01.000000'),
       ('Успешно, хотим еще', '2021-02-02 10:00:01.000000');

INSERT INTO PROJECT (NAME, COSTUMER, FINISH_DATE, METHODOLOGY, PROJECT_MANAGER, TEAM_NAME_ID)
VALUES ('iPay', 'BelBank', '2021-12-31 10:00:01.000000', 'Spring boot', 'MANAGER_1', 1),
       ('qBank', 'ExtBank', '2021-12-31 10:00:01.000000', 'Spring boot', 'MANAGER_2', 2);

INSERT INTO EMPLOYER(NAME, SURNAME, PATRONYMIC, MAIL, TEL, BIRTHDAY, EXPERIENCE, EMPLOYMENT_DATA, PROJECT_ID,
                     WORK_SKILL, ENGLISH_SKILL, SKYPE, FEEDBACK_ID)
VALUES ('Иван', 'Иванов', 'Иванович', 'ivan@mail.ru', '(232)11-22-00', '1990-01-01 10:00:01.000000', 70,
        '2018-01-10 10:00:01.000000', 1, 'm1', 'B1', 'ivanSkype', 1),
       ('Олег', 'Олегов', 'Олегович', 'oleg@mail.ru', '(232)11-22-01', '1991-01-01 10:00:01.000000', 80,
        '2019-01-10 10:00:01.000000', 1, 'm2', 'B2', 'olegSkype', 2),
       ('Петр', 'Петров', 'Петрович', 'petr@mail.ru', '(232)11-22-02', '1992-02-02 10:00:01.000000', 90,
        '2020-01-10 10:00:01.000000', 1, 's1', 'C1', 'petrSkype', 1),
       ('Глеб', 'Глебов', 'Глебович', 'gleb@mail.ru', '(232)11-22-03', '1993-03-03 10:00:01.000000', 99,
        '2020-02-10 10:00:01.000000', 1, 's2', 'C2', 'glebSkype', 2);

INSERT INTO TEAM (TEAM_NAME_ID, EMPLOYER_ID)
VALUES (1, 1),
       (1, 3),
       (2, 2),
       (2, 4);
